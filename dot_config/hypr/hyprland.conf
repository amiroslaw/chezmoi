#{{{ ## AUTOSTART ###
# for KeePassXC maybe it should be wayland
# env = QT_QPA_PLATFORM,xcb
env = QT_QPA_PLATFORM,wayland;xcb
$scratchpad = "$XDG_CONFIG_HOME/hypr/scratchpad.clj"
# nvim-qt doesn't work with wayland
# env = QT_QPA_PLATFORM,wayland
# Autostart necessary processes (like notifications daemons, status bars, etc.)
# Or execute your favorite apps at launch like this:
exec-once = mega-sync
exec-once = $TERMINAL
exec-once = systemctl  --user start hyprpolkitagent
exec-once = ${CARGO_HOME}/bin/kanata

exec-once = waybar
exec-once = nm-applet --indicator
# exec-once = wl-paste --watch cliphist store
exec-once = wl-paste --type text --watch cliphist store
exec-once = wl-paste --type image --watch cliphist store
# exec-once = wl-paste -t text --watch clipman store --max-items=30 --histpath="~/.local/share/clipman/clipman.json" 1>> ~/.local/share/clipman/clipman.log 2>&1
# exec-once = wl-paste -p -t text --watch clipman store -P --histpath="~/.local/share/clipman/clipman-primary.json"
# exec-once = setbg
# exec-once = pueued
# exec-once = kanata -c $HOME/.config/kanata/kanata.kbd
# sleep 200 && newsboat -x reload &
# exec-once = nm-applet &
# exec-once = waybar & hyprpaper & firefox
#}}} 

#{{{ ## KEYBINDINGS ###

# See https://wiki.hyprland.org/Configuring/Keywords/
$sup = SUPER

# Example binds, see https://wiki.hyprland.org/Configuring/Binds/ for more
bind = $sup, A, exec, notify-send $scratchpad
bind = $sup, Return, exec, $TERMINAL
bind = $sup SHIFT, Return, exec, $TERM_LT
bind = $sup, Q, killactive,
bind = $sup SHIFT, Q, exec, qu.clj kill-any
bind = $sup, Space, togglefloating,
# bind = $sup SHIFT, Space, pseudo, # dwindle meh
bind = $sup, backslash, togglesplit, # dwindle
bind = $sup, F, fullscreen, 1
bind = $sup CTRL, F, fullscreen, 0
bind = $sup, U, focusurgentorlast,

# Select previous / next active desktop
# bind = $sup, N, workspace, next ??
bind = $sup, N, workspace, m+1
bind = $sup, P, workspace, m-1
bind = $sup, TAB, workspace, previous
# First empty
bind = $sup CTRL, N, workspace, empty:next
bind = $sup CTRL, P, workspace, empty:prev

# Move focus
bind = $sup, H, movefocus, l
bind = $sup, J, movefocus, d
bind = $sup, K, movefocus, u
bind = $sup, L, movefocus, r

bind = ALT, Tab, cyclenext, visible tiled
# cyclenext all
bind = CTRL, Tab, cyclenext, visible floting

# Tabbs/Groups
bind = $sup, G, togglegroup
bind = $sup CTRL, H, movewindoworgroup, l
bind = $sup CTRL, L, movewindoworgroup, r
bind = $sup CTRL, K, movewindoworgroup, u
bind = $sup CTRL, J, movewindoworgroup, d
bind = $sup SHIFT, H, changegroupactive, b
bind = $sup SHIFT, L, changegroupactive, f
# TODO check if it's a group and use movegroupwindow or moveactive
bind = $sup SHIFT, K, movegroupwindow, b
bind = $sup SHIFT, J, movegroupwindow, f
# bind = $sup SHIFT, J, swapnext,

# TODO movewindoworgroup does the same
# bind = $sup SHIFT, H, moveactive, l
# bind = $sup SHIFT, J, moveactive, d
# bind = $sup SHIFT, K, moveactive, u
# bind = $sup SHIFT, L, moveactive, r

# Switch workspaces with mainMod + [0-9]
bind = $sup, 1, workspace, 1
bind = $sup, 2, workspace, 2
bind = $sup, 3, workspace, 3
bind = $sup, 4, workspace, 4
bind = $sup, 5, workspace, 5
bind = $sup, 6, workspace, 6
bind = $sup, 7, workspace, 7
bind = $sup, 8, workspace, 8
bind = $sup, 9, workspace, 9
bind = $sup, 0, workspace, 10
bind = $sup SHIFT, 1, movetoworkspace, 1
bind = $sup SHIFT, 2, movetoworkspace, 2
bind = $sup SHIFT, 3, movetoworkspace, 3
bind = $sup SHIFT, 4, movetoworkspace, 4
bind = $sup SHIFT, 5, movetoworkspace, 5
bind = $sup SHIFT, 6, movetoworkspace, 6
bind = $sup SHIFT, 7, movetoworkspace, 7
bind = $sup SHIFT, 8, movetoworkspace, 8
bind = $sup SHIFT, 9, movetoworkspace, 9
bind = $sup SHIFT, 0, movetoworkspace, 10

# Scroll through existing workspaces with mainMod + scroll
bind = $sup, mouse_down, workspace, e+1
bind = $sup, mouse_up, workspace, e-1

# Move/resize windows with mainMod + LMB/RMB and dragging
# or binde to SHIFT hjkl
bind = $sup, right, resizeactive, 10% 0%
bind = $sup, left, resizeactive, -10% 0%
bind = $sup, down, resizeactive, 0% 10%
bind = $sup, up, resizeactive, 0% -10%

bindm = $sup, mouse:272, movewindow
bindm = $sup, mouse:273, resizewindow
# double_click but it had to be in floting mode in order to have sense
# bind = , mouse:272, exec, sleep 0.2 && hyprctl dispatch submap reset
# bind = , mouse:272, submap, double_click
# submap = double_click
# bind = , mouse:272, togglefloating,
# submap = reset
# bindc = , mouse:273, togglefloating
# LMB -> 272
# RMB -> 273

# Laptop multimedia keys for volume and LCD brightness
# bind = $sup, Plus, exec, pactl set-sink-volume "$(pacmd list-sinks | grep '* index' | awk '{print $3}')" +15%
# bind = $sup SHIFT, Minus, exec, pactl set-sink-volume "$(pacmd list-sinks | grep '* index' | awk '{print $3}')" -15%
bindel = $sup, Equal, exec, wpctl set-volume -l 1 @DEFAULT_AUDIO_SINK@ 5%+
bindel = $sup, Minus, exec, wpctl set-volume @DEFAULT_AUDIO_SINK@ 5%-
bindl = $sup, Slash, exec, wpctl set-mute @DEFAULT_AUDIO_SINK@ toggle
bindl = $sup SHIFT, Slash, exec, audio.sh toggle
bind = $sup CONTROL, Slash, exec, audio.sh
bindel = ,XF86AudioRaiseVolume, exec, wpctl set-volume -l 1 @DEFAULT_AUDIO_SINK@ 5%+
bindel = ,XF86AudioLowerVolume, exec, wpctl set-volume @DEFAULT_AUDIO_SINK@ 5%-
bindl = ,XF86AudioMute, exec, wpctl set-mute @DEFAULT_AUDIO_SINK@ toggle
bindl = ,XF86AudioMicMute, exec, wpctl set-mute @DEFAULT_AUDIO_SOURCE@ toggle
bindel = ,XF86MonBrightnessUp, exec, brightnessctl -e4 -n2 set 5%+
bindel = ,XF86MonBrightnessDown, exec, brightnessctl -e4 -n2 set 5%-

# Requires playerctl
# bindl = $sup, M, exec, mpc toggle
# bindl = $sup, Comma, exec, mpc prev
# bindl = $sup, Period, exec, mpc next
bindl = $sup, M, exec, playerctl play-pause
bindl = $sup, Comma, exec, playerctl previous
bindl = $sup, Period, exec, playerctl next
bindl = , XF86AudioNext, exec, playerctl next
bindl = , XF86AudioPrev, exec, playerctl previous
bindl = , XF86AudioPause, exec, playerctl play-pause
bindl = , XF86AudioPlay, exec, playerctl play-pause
#}}} 

#{{{ ## APPS
bind = $sup, Escape, exec, makoctl dismiss -a
bind = $sup SHIFT, Escape, exec, makoctl restore
bind = $sup CTRL, F1, exec, "$XDG_CONFIG_HOME/hypr/rofi_keybinds.sh"
bind = $sup, F1, exec, $BROWSER
bind = $sup, F2, exec, /opt/idea-IU-212.5284.40/bin/idea.sh
bind = $sup, F3, exec, eval $(printf "$TERM_LT $TERM_LT_RUN" "vifm" "vifm")
bind = $sup, F4, exec, pcmanfm
bind = $sup, F5, exec, keecli.sh
bind = $sup, F6, exec, $scratchpad -n newsboat $(printf "$TERMINAL $TERM_RUN" "newsboat" "newsboat")
bind = $sup, F7, exec, wezterm start note --cwd ~/Documents/notebook -- nvim
bind = $sup, F8, exec, task sync && $scratchpad task $(printf "$TERM_LT $TERM_LT_RUN" task taskwarrior-tui)
bind = $sup, F9, exec, todo.lua add
bind = $sup, F10, exec, mpv.lua -o ~/Videos
bind = $sup, F11, exec, sh -c $(ls ~/.bin | rofi -dmenu)
bind = $sup, F12, exec, rofi -show power-menu -modi power-menu:$ROFI/power.sh

# Scratchpad
# silent will move and hide window
bind = $sup CTRL, D, exec, $scratchpad --menu
bind = $sup, S, exec, $scratchpad --toggle
bind = $sup CTRL, S, exec, $scratchpad --add
# bind = $sup, Z, movetoworkspacesilent, special:pad
# to exit special mode; move window to any window
# bind = $sup CTRL, Z, togglespecialworkspace, pad 
bind =  ,F12, exec, $scratchpad -n drop $(printf "$TERMINAL $TERM_RUN" "drop" "")
bind = $sup SHIFT, U, exec, $scratchpad -n newsboat $(printf "$TERMINAL $TERM_RUN" "newsboat" "newsboat")
bind = $sup CTRL, U, exec, task sync && $scratchpad -n task $(printf "$TERM_LT $TERM_LT_RUN" "task" "taskwarrior-tui")

# ROFI
bind = $sup, D, exec, $scratchpad --switcher
# bind = $sup, D, exec, rofi -modi window,calc,filebrowser -show window -show-icons -sidebar-mode -monitor -4
bind = $sup SHIFT, D, exec, rofi -modi drun,keys,run -show drun -show-icons -sidebar-mode -monitor -4 -matching fuzzy
bind = $sup CTRL, M, exec, $ROFI/mount-launcher.sh
# bind = $ALT, Space, exec, $ROFI/expander/expander.sh
bind = $sup, V, exec, clip.sh
# bind = $sup, V, exec, cliphist list | GDK_SCALE=2 rofi -dmenu | cliphist decode | wl-copy

# Chat
bind = $sup, R, exec, chat.clj ask --output scratchpad
bind = $sup SHIFT, R, exec, chat.clj action --action-list --output scratchpad
bind = $sup CTRL, R, exec, chat.clj ask --list --output scratchpad

# youtube
bind = $sup, Y, exec, yt.clj playlist --channel
bind = $sup SHIFT, Y, exec, mpv.lua -o
bind = $sup CTRL, Y, exec, yt.clj search --input


# internet
bind = $sup, I, exec, rofi-buku
bind = $sup SHIFT, I, exec, ~/.config/qutebrowser/userscripts/session.sh
bind = $sup CTRL, I, exec, ~/.config/qutebrowser/userscripts/session.sh webapp

# remove video, audio or restore
bind = $sup SHIFT, Delete, exec, rmmpv-playing.sh
bind = $sup CTRL, Delete, exec, rmmpd-playing.sh
bind = $sup, Delete, exec, eval $(printf "$TERM_LT $TERM_LT_RUN" "trash" "gomi --restore")

# linux process
bind = $sup, BackSpace, exec, eval $(printf "$TERM_LT $TERM_LT_RUN" "top" "btop")
bind = $sup SHIFT, BackSpace, exec, $ROFI/kill
bind = $sup CTRL, BackSpace, exec, hyprctl kill

# pomodoro
bind = $sup, X, exec, pomodoro.lua add -n
bind = $sup SHIFT, X, exec, pomodoro.lua stop -n && task sync
bind = $sup CTRL, X, exec, pomodoro.lua menu -n

# translator
bind = $sup, T, exec, search.lua --enpl -c
bind = $sup SHIFT, T, exec, $ROFI/tran/trans-launcher.sh
bind = $sup CTRL, T, exec, search.lua --enpl -p

#}}} 

#{{{ ## RULES
# windowrule v1 syntax is gone. windowrule now behaves like windowrule, deprecating the windowrule keyword
# See https://wiki.hyprland.org/Configuring/Window-Rules/ for more
# See https://wiki.hyprland.org/Configuring/Workspace-Rules/ for workspace rules

# move
windowrule = workspace 3, initialClass:^(vifm)$
windowrule = workspace 9, initialClass:^(top)$
windowrule = workspace 5 silent, initialClass:^(audio)$
# or scratchpad
# windowrule = workspace special:drop, class:^(drop)$

windowrule = float,class:file-roller
windowrule = center,class:file-roller

# windowrule = float,class:SpeedCrunch
# windowrule = center,class:SpeedCrunch
# windowrule = size 500 500,class:SpeedCrunch

windowrule = fullscreen, class:mpv
windowrule = float, class:^(KeePassXC)$
windowrule = opacity 1.0 0.1, class:^(KeePassXC)$
windowrule = center,class:KeePassXC
windowrule = size 1100 600,class:KeePassXC

windowrule = float, title:^(pavucontrol)$
windowrule = center, class:^(pavucontrol|org.pulseaudio.pavucontrol|com.saivert.pwvucontrol)$
windowrule = float, title:^(blueman-manager)$
windowrule = float, title:^(nm-connection-editor)$

windowrule = float,class:zenity
windowrule = float,class:^([Yy]ad)$
windowrule = float, class:^([Qq]alculate-gtk)$
windowrule = float,class:menu

# scratchpads 
# workspace = special:special, gapsout:30
windowrule = workspace special:drop, class:^(drop)$
windowrule = float, class:^(drop)$
windowrule = size 90% 70%, class:^(drop)$
windowrule = move 5% 50, class:^(drop)$
windowrule = workspace special:chat, class:^(chat)$
windowrule = float, class:^(chat)$
windowrule = size 900 600, class:^(chat)$
windowrule = workspace special:news, class:^(news)$
windowrule = float, class:^(news)$
windowrule = size 900 600, class:^(news)$

windowrule = float,class:rsvp
windowrule = pin,class:rsvp
windowrule = center,class:rsvp
windowrule = size 1100 150,class:rsvp

windowrule = float,class:cheatsh
windowrule = float,class:read

windowrule = float,class:task
windowrule = center,class:task
windowrule = size 1000 90%,class:task

windowrule = float,class:music
windowrule = center,class:music
windowrule = size 1000 90%,class:music

windowrule = float,class:audio
windowrule = center,class:audio
windowrule = size 500 150,class:audio

windowrule = float,class:trash
windowrule = center,class:trash
windowrule = size 700 90%,class:trash

windowrule = float,class:qb
windowrule = center,class:qb
windowrule = size 700 400,class:qb

windowrule = float,class:ytfzf
windowrule = center,class:ytfzf
windowrule = size 1000 900,class:ytfzf

windowrule = float,class:videopopup
windowrule = pin,class:videopopup
windowrule = size 380 210,class:videopopup
windowrule = move 100%-383 100%-230,class:videopopup
# windowrule = noborder,class:videopopup
# windowrule = nofocus,class:videopopup

windowrule = float,class:application.Main
windowrule = float,class:ovh.miroslaw.timefx.TimeFX

## layer
layerrule = noanim, namespace:rofi
layerrule = blur,rofi
layerrule = ignorezero,rofi
layerrule = blur,notifications
layerrule = ignorezero,notifications

# Ignore maximize requests from apps. You'll probably like this.
# windowrule = suppressevent maximize, class:.*
# Fix some dragging issues with XWayland
windowrule = nofocus,class:^$,title:^$,xwayland:1,floating:1,fullscreen:0,pinned:0

# Dialog windows – float+center these windows.
windowrule = center, title:^(Open File)(.*)$
windowrule = center, title:^(Select a File)(.*)$
windowrule = center, title:^(Choose wallpaper)(.*)$
windowrule = center, title:^(Open Folder)(.*)$
windowrule = center, title:^(Save As)(.*)$
windowrule = size 70% 60%, title:^(Save As)$
windowrule = center, title:^(Library)(.*)$
windowrule = center, title:^(File Upload)(.*)$
windowrule = center, title:^(.*)(wants to save)$
windowrule = center, title:^(.*)(wants to open)$
windowrule = float, title:^(Open File)(.*)$
windowrule = float, title:^(Select a File)(.*)$
windowrule = float, title:^(Choose wallpaper)(.*)$
windowrule = float, title:^(Open Folder)(.*)$
windowrule = float, title:^(Save As)(.*)$
windowrule = float, title:^(Library)(.*)$
windowrule = float, title:^(File Upload)(.*)$
windowrule = float, title:^(.*)(wants to save)$
windowrule = float, title:^(.*)(wants to open)$
windowrule = float, initialTitle:(Open Files)
windowrule = size 70% 60%, initialTitle:(Open Files)

#}}} 
# xwayland {
#     force_zero_scaling = true
# }

#{{{ ## INPUT ###
# See https://wiki.hyprland.org/Configuring/Monitors/
monitor=,preferred,auto,auto

# https://wiki.hyprland.org/Configuring/Variables/#input
input {
    kb_layout = pl
    kb_variant =
    kb_model =
    kb_options =
    kb_rules =

    follow_mouse = 1

    sensitivity = 0 # -1.0 - 1.0, 0 means no modification.

    touchpad {
        natural_scroll = false
    }
}

# https://wiki.hyprland.org/Configuring/Variables/#gestures
gestures {
    workspace_swipe = false
}

# Example per-device config
# See https://wiki.hyprland.org/Configuring/Keywords/#per-device-input-configs for more
device {
    name = epic-mouse-v1
    sensitivity = -0.5
}
#}}} 

dwindle {
  # pseudotile = yes
}

source = ~/.config/hypr/look.conf
# source = ~/.config/hypr/comments.conf

# vi: foldmethod=marker
